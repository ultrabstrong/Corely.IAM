@page "/select-account"
@model Corely.IAM.Web.Pages.Authentication.SelectAccountModel
@{
    Layout = "_AuthLayout";
    ViewData["Title"] = "Select Account";
}

<div class="auth-card">
    <h2 class="text-center mb-4">Select Account</h2>

    @if (!string.IsNullOrWhiteSpace(Model.ErrorMessage))
    {
        <div class="alert alert-danger" role="alert">@Model.ErrorMessage</div>
    }

    <form method="get">
        <div class="input-group mb-3">
            <input type="text" class="form-control" name="Search" value="@Model.Search"
                   placeholder="Search by name..." autocomplete="off" autofocus />
            <button class="btn btn-outline-secondary" type="submit">
                <i class="bi bi-search"></i>
            </button>
            @if (!string.IsNullOrWhiteSpace(Model.Search))
            {
                <a href="@Corely.IAM.Web.AppRoutes.SelectAccount" class="btn btn-outline-secondary">
                    <i class="bi bi-x-lg"></i>
                </a>
            }
        </div>
    </form>

    <div class="list-group">
        @foreach (var account in Model.Accounts)
        {
            <form method="post" class="d-inline">
                @Html.AntiForgeryToken()
                <input type="hidden" name="AccountId" value="@account.Id" />
                <button type="submit" class="list-group-item list-group-item-action">
                    <div class="fw-semibold">@account.AccountName</div>
                    <small class="text-muted font-monospace">@account.Id</small>
                </button>
            </form>
        }
        @if (Model.Accounts.Count == 0)
        {
            <div class="list-group-item text-muted text-center">
                @(string.IsNullOrWhiteSpace(Model.Search) ? "No accounts found." : "No accounts match your search.")
            </div>
        }
    </div>

    @if (Model.TotalPages > 1)
    {
        <nav class="mt-3">
            <ul class="pagination pagination-sm justify-content-center mb-0">
                <li class="page-item @(Model.PageNumber <= 1 ? "disabled" : "")">
                    <a class="page-link" href="@Url.Page("SelectAccount", new { PageNumber = Model.PageNumber - 1, Search = Model.Search })">
                        <i class="bi bi-chevron-left"></i>
                    </a>
                </li>
                <li class="page-item disabled">
                    <span class="page-link">@Model.PageNumber / @Model.TotalPages</span>
                </li>
                <li class="page-item @(Model.PageNumber >= Model.TotalPages ? "disabled" : "")">
                    <a class="page-link" href="@Url.Page("SelectAccount", new { PageNumber = Model.PageNumber + 1, Search = Model.Search })">
                        <i class="bi bi-chevron-right"></i>
                    </a>
                </li>
            </ul>
        </nav>
    }

    <div class="mt-3">
        <hr />
        <a href="@Corely.IAM.Web.AppRoutes.CreateAccount" class="btn btn-outline-primary w-100">
            <i class="bi bi-plus-circle"></i> Create New Account
        </a>
    </div>
</div>
